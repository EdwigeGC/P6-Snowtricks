{% extends 'base.html.twig' %}

{% block title %}Snowtricks - {{ trick.name }} details{% endblock %}

{% block body %}
    <!--main container-->
    <div class="container">
    <!--main image and trick's name-->
        <section class="py-5 text-center container">
            <div class="row py-lg-5">
                <div class="col-lg-6 col-md-8 mx-auto">
                    <h1 class="fw-light">{{ trick.name }} </h1>
                    {% for picture in trick.pictures %}
                    <img src="{{ asset('uploads/tricks/'~ picture.fileName)}}" class="img-thumbnail" alt="{{ picture.title }}">
                    {% endfor %}

                    {% if app.user %}
                    <p>
                            <a href="{{ path('edit_trick', {'id': trick.id}) }}"><i class="fas fa-pencil-alt"></i></a>
                            <a href="{{ path('delete_trick', {'id': trick.id}) }}" onclick="return confirm('Do you really want to delete this trick?')"><i class="fas fa-trash-alt"></i></a>
                    </p>
                        {% endif %}
                </div>
            </div>
        </section>


    <!--medias-->

        <div class="container">
            <div class="row row-cols-4 my-2 py-2">

                {% for picture in trick.pictures %}
                        <img src="{{ asset('uploads/tricks/'~ picture.fileName)}}" class="img-thumbnail" alt="{{ picture.title }}">
                {% endfor %}

                {% for video in trick.videos %}
                        <iframe width="560" height="315" src="{{ video.url }}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                {% endfor %}
            </div>
        </div>

    <!--Trick's details-->
        <div class="container">
            <div class="row">
                <div class= "col-md-10">
                    <h2> Description </h2>
                    <p class="text-wrap">{{ trick.description }}</p>
                </div>
            </div>

            <div class="row">
                <div class= "col-md-10">
                <p><span class="badge bg-secondary">{{ trick.category.name }}</span></p>
                    <p>Author:{{ trick.user.photo}} {{ trick.user.username }}</p>
                <p>Créé le {{ trick.creationDate|date("d/m/Y à H:i:s") }} {{ trick.modificationDate is not empty ?  "mis à jour le " ~trick.modificationDate|date("d/m/Y à H:i:s") : "" }} </p>
                </div>
            </div>
        </div>
        <hr>
    <!--chat room-->
        <div>
            <h2>Comments</h2>
            {% if app.user %}
                    <div class="mb-3">
                        {{ form_start(form) }}

                        {{ form_widget(form) }}

                        <button class="btn btn-primary" type="submit">Publish</button>

                        {{ form_end(form) }}

                    </div>

            {% else %}
                <p>To let a comment please
                    <a href="{{ path('user_login') }}">sign in</a>
                    or join us and
                    <a href="{{ path('user_registration') }}">sign up</a>
                </p>
            {% endif %}

            <hr>

            {% if trick.comments|length >0 %}
                {% for comment in trick.comments %}
                    <div class="bg-light">
                        <img src="{{ asset('uploads/profile/'~ comment.user.photo)}}" class="img-thumbnail rounded circle" alt="{{ comment.user.username }}">
                        <p>{{ comment.user.username }}, le {{ comment.creationDate|date("d/m/Y à H:i:s") }}</p>
                        <blockquote>
                            <p>{{ comment.content }}</p>
                        </blockquote>
                    </div>
                {% endfor %}
            {% else %}
                <p>Be the first one to comment this trick !</p>

            {% endif %}

        </div>
    </div>
{% endblock %}